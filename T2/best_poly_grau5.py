import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.2102, -4.0941, -4.0577, -3.8972, -3.8612, -3.7677, -3.6329, -3.6108, -3.4555, -3.3902, -3.2841, -3.2072, -3.1331, -3.0156, -2.9769, -2.8568, -2.7855, -2.6913, -2.6524, -2.4983, -2.4564, -2.3612, -2.3003, -2.1588, -2.0369, -2.0105, -1.8905, -1.8582, -1.7474, -1.6806, -1.5242, -1.4298, -1.4028, -1.295, -1.2337, -1.1432, -1.0025, -0.9581, -0.8267, -0.7873, -0.6259, -0.5683, -0.5132, -0.3637, -0.3154, -0.2426, -0.1035, -0.084, 0.0633, 0.1538, 0.2171, 0.2689, 0.4369, 0.4677, 0.5946, 0.6814, 0.7205, 0.8329, 0.9648, 0.9939, 1.0782, 1.1599, 1.3226, 1.3987, 1.4922, 1.5187, 1.6213, 1.709, 1.8361, 1.9326, 2.0298, 2.1068, 2.1861, 2.2362, 2.3241, 2.4383, 2.5617, 2.6363, 2.732, 2.768, 2.9103, 2.9859, 3.0561, 3.1221, 3.2566, 3.334, 3.4074, 3.456, 3.5852, 3.6411, 3.7474, 3.8517, 3.9181, 4.0037, 4.1203, 4.2332]
y = [2.8283, 4.6435, 4.3302, 6.2768, 6.2379, 6.038, 7.3, 7.3555, 7.6275, 7.5718, 7.5726, 8.3447, 7.3678, 8.0408, 7.9367, 7.1445, 6.7612, 6.7426, 6.5942, 6.3007, 6.3207, 6.087, 5.7131, 5.5603, 5.2724, 5.2374, 4.8749, 4.7009, 4.3804, 4.1163, 4.276, 3.9351, 3.9222, 3.7295, 4.0898, 4.102, 3.7594, 3.7461, 3.5127, 3.6715, 5.1885, 3.2119, 2.3758, 4.5335, 4.6306, 2.8189, 4.7649, 5.0423, 4.9043, 5.1027, 5.3272, 5.1992, 5.7635, 5.6616, 5.5755, 4.541, 5.8164, 6.0614, 5.8788, 6.1403, 5.8131, 5.9733, 5.899, 5.7467, 5.6407, 6.0443, 5.8491, 5.4594, 5.4741, 4.8032, 5.0485, 4.2942, 4.8427, 4.5604, 4.1822, 3.6947, 3.5796, 3.4302, 2.6812, 3.2232, 2.6038, 2.4452, 1.7219, 2.5908, 1.8743, 1.9545, 2.6332, 2.3416, 2.5937, 2.8532, 3.0635, 3.3954, 3.8811, 5.2608, 5.9846, 7.8298]

a0, a1, a2, a3, a4, a5 = best_poly(x, y, 5)

print(f'{a0 = } , {a1 = }, {a2 = }, {a3 = }, {a4 = }, {a5 = }')