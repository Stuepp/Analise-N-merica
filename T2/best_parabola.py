import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [0.1112, 0.1491, 0.3443, 0.4504, 0.5567, 0.6734, 0.7066, 0.8601, 1.0262, 1.1511, 1.2716, 1.3175, 1.429, 1.5432, 1.7138, 1.8091, 1.873, 1.9784, 2.1981, 2.2706, 2.3865, 2.4801, 2.6316, 2.683, 2.8887, 3.007, 3.0585, 3.1525, 3.2967, 3.4708, 3.4909, 3.6675, 3.7709, 3.8743, 3.9982, 4.0879, 4.2053, 4.3656, 4.5229, 4.5804, 4.7618, 4.8782, 4.9212, 5.0156, 5.2157, 5.3149, 5.3636, 5.5582, 5.695, 5.7396, 5.9065, 6.0082, 6.1035, 6.2212, 6.3631, 6.4471, 6.5315, 6.6407, 6.799, 6.9205, 7.0002, 7.1058, 7.3071, 7.3374, 7.4785, 7.5748, 7.7267, 7.7947, 8.0056, 8.0691, 8.1538, 8.352, 8.4553, 8.4975, 8.6403, 8.8304, 8.9033, 9.002, 9.0935, 9.2202, 9.3451, 9.5223, 9.6309, 9.6919, 9.8682, 9.9653]
y = [7.0807, 5.4217, 6.4759, 6.4154, 6.6426, 8.2993, 6.3784, 6.0005, 6.1781, 5.8405, 5.6985, 5.7505, 5.6503, 5.383, 5.349, 5.5214, 5.5639, 5.4348, 4.6793, 5.2327, 5.1965, 4.6971, 4.6534, 4.8018, 4.603, 3.9119, 4.6942, 4.7888, 5.1987, 3.1235, 3.8167, 4.4567, 4.9727, 4.1975, 4.2984, 4.206, 3.965, 3.661, 4.643, 3.8011, 3.8571, 4.0095, 3.8551, 3.9177, 4.0211, 4.2114, 3.8496, 3.7442, 4.4793, 4.0671, 3.9733, 4.092, 3.7146, 5.426, 3.8685, 4.1123, 4.0741, 4.4269, 3.726, 4.0893, 3.8025, 4.19, 3.8948, 4.2175, 5.0088, 4.3457, 4.536, 3.6463, 5.0922, 3.9892, 4.1934, 4.4321, 4.3067, 4.7062, 4.9825, 4.8035, 4.8923, 5.729, 4.9191, 6.6329, 4.9987, 4.961, 5.1389, 6.1438, 5.3642, 5.473]
a0, a1, a2 = best_poly(x, y, 2)

print(f'{a0 = } , {a1 = }, {a2 = }')