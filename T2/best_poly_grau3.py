import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.8919, -4.8049, -4.6601, -4.5484, -4.4172, -4.2296, -4.1546, -3.9452, -3.8041, -3.6642, -3.6099, -3.4487, -3.3502, -3.1731, -3.0026, -2.8712, -2.7846, -2.6873, -2.5086, -2.3871, -2.237, -2.0675, -2.034, -1.8344, -1.6634, -1.5249, -1.4379, -1.3692, -1.1303, -1.0302, -0.9336, -0.7496, -0.5947, -0.5084, -0.3662, -0.1853, -0.0722, 0.0598, 0.1026, 0.2484, 0.4862, 0.5318, 0.6775, 0.8733, 0.9035, 1.1253, 1.2057, 1.3904, 1.4807, 1.5923, 1.7619, 1.8437, 2.1017, 2.1518, 2.3312, 2.5094, 2.6399, 2.7738, 2.7825, 2.9896, 3.1292, 3.1852, 3.3698, 3.5207, 3.7133, 3.83, 3.9633, 4.052, 4.1553, 4.3089, 4.4973, 4.634, 4.7727, 4.7986, 4.9397, 5.1065, 5.2379, 5.4359, 5.5575, 5.6034, 5.7979, 5.9591]
y = [3.4536, 4.9826, 5.5971, 5.65, 6.8136, 6.9709, 6.361, 7.0821, 7.0781, 7.3055, 7.0264, 7.1711, 7.2231, 7.3151, 8.2685, 7.4825, 7.3055, 7.2195, 7.2946, 6.7377, 7.3102, 6.8919, 6.9555, 6.8418, 6.6435, 6.509, 5.757, 6.7127, 6.5023, 6.1477, 5.9349, 5.9001, 5.9153, 5.5018, 5.6012, 5.3073, 5.3332, 3.008, 5.0972, 4.9668, 4.3563, 5.1008, 3.8137, 4.0692, 3.8257, 3.5449, 3.5842, 3.2985, 3.2502, 3.1551, 3.2131, 2.8551, 3.7952, 2.1677, 2.5329, 2.7027, 2.8279, 2.586, 3.6895, 2.7172, 3.1976, 2.818, 1.9568, 2.756, 3.4892, 2.9318, 3.1157, 3.3884, 3.4557, 3.7183, 3.136, 4.4398, 4.9626, 4.7728, 4.9803, 5.9646, 6.5272, 6.476, 7.1296, 5.2912, 8.6775, 8.5382]

a0, a1, a2, a3 = best_poly(x, y, 3)

print(f'{a0 = } , {a1 = }, {a2 = }, {a3 = }')